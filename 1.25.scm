(define (fast-expt b n)
  (cond ((= n 0) 1)
        ((even? n) (square (fast-expt b (/ n 2))))
        (else (* b (fast-expt b (- n 1))))))

(define (even? n)
  (= (remainder n 2) 0))

(define (show)
  (display (fast-expt 1008 1009)))

; 3102250751876094580497108829939919847753243025197328578173096636922667311418850844784920674453510713041966531888093562874377980666210468451736237320590648744764455739652076402049286115671574007887859369198887191224730882561858861422401364259164771397788774694331154851060419820173987014297206452049797448076515657689914350326785998756914860767115150023360859073001117873974159512990641905906998840081775418874516786924565367640252977279052773671631675677161288582376271874222666330414838593443327603039894900286010296363752257823927884682366196356656047727758740649392401561070420691539122996636898213346071473619016223538322759619586416411788653131188369758287329379995691877834048537375520299527828450274707696405338557155296510283152706630975127900325553050167400925226849187549072709991502803194646975287301211623617122379874238871402483336804944170513395637430516531328459648004765380742174864848970434156562436167479653326488840342735597383765624596681095836852479513402064411164292066230324761032722833430035935333884493091821334636738746328909513528828875601198532340480756815192672677544760753883116920367250056549602942323759047847513282762678377917220135493574505295636242953555812949328590258040411203509715180786080488931654212606524479943649608469010554843688618562076378771203598952893857375097612978031810074419709643985836543593180397531663625887717857413460687226127934977155058939694191036411594810287900750339972957946340924622107148376397466958654394800138607679351011027366173121772846274722410537178181823858501460493361391520873019591837495901722446814611097223885734261226657623956125716673196377474497787593890306079877731056440128845415927545578432807476604078455390052382223004897895155030444557259904419934522495494097815857052575184175651546269542859016011378297091929758366418477762560416540953741633284021064016848016560091005216422355320883573165872574763632228880007463070926319326237770826861244350111224136260672962917950799920600938672414286305239398082588971523377417774232697888869253974828495345700748385694303996076482510277045091319049190883781299376165553864142032066934355384481911742756826272121101890846305418729885556566018664656647516096672528813338692350136350037863835842620820146076052279096212600624785916550965914816414352169629327739879319674936951321830983846698732958696806079746671477337315392551637904329724245291402246843759185420421309021881638579911019328309764849589925098086003324938119048648706458081183798815050982382096633004590796312235349649645738374544481165887651528097226445249096820682726274329221648969194572303051074329580338083695892074476202724495064788342749738498240466935712637275192907071327211332856714556210074512617527049515673505264937951083589110905877898419933537478276992036910473623365859445611067857025716222302096414168242684964461157764397621602531789604101433065725775269191650650160572806576613060781938520735957631942485502205557538618454634681469298273510975840355015257938678019702412454227221466499619017007463951208603972307913801728
; The above number is the number which will need to be calculated if we use fast-expt.
; That is only for smallest prime above 1,000. There will be millions for larger primes.
; Therefore, it would require more space, more memory to be alocated.
; My conclusion is that, yes, the program will works. But it will have to allocate much
; more memories.